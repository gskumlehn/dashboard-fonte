{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h1>Volume de Operações</h1>

<div class="filters">
    <label for="mode-select">Filtro:</label>
    <select id="mode-select">
        <option value="ultimo" selected>Último</option>
        <option value="mes">Mês específico</option>
        <option value="ano">Ano específico</option>
    </select>

    <!-- Último: escolher unidade (mês, trimestre, ano) -->
    <div id="ultimo-controls" style="display:inline-flex;align-items:center;gap:.5rem;">
        <label for="ultimo-select" style="margin-bottom:0">Último:</label>
        <select id="ultimo-select">
            <option value="month">Mês (agregado por dia)</option>
            <option value="quarter">Trimestre (agregado por semana)</option>
            <option value="year">Ano (agregado por mês)</option>
        </select>
        <button id="btn-last-month" class="btn" type="button">Último mês</button>
        <button id="btn-last-quarter" class="btn" type="button">Último trimestre</button>
        <button id="btn-last-year" class="btn" type="button">Último ano</button>
    </div>

    <!-- Mês específico -->
    <div id="mes-controls" style="display:none;align-items:center;gap:.5rem;">
        <label for="month-input" style="margin-bottom:0">Mês:</label>
        <input type="month" id="month-input" />
    </div>

    <!-- Ano específico -->
    <div id="ano-controls" style="display:none;align-items:center;gap:.5rem;">
        <label for="year-select" style="margin-bottom:0">Ano:</label>
        <select id="year-select"></select>
    </div>

    <button id="apply-filters" class="btn">Aplicar</button>
</div>

<div class="table-card">
    <canvas id="volumeChart" width="800" height="320"></canvas>
    <div id="chart-loader" style="display:none;">Carregando...</div>
    <div id="chart-error" style="display:none;color:red;"></div>
</div>

<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
<script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
{% endblock %}
